---
title: Giftify 친구 관계 모델링 트러블슈팅 로그
description: Friend vs Follow, 그리고 “일급 시민” 친구 관계를 어떻게 설계할 것인가
pubDate: 2026-02-12
updatedDate: 2026-02-12
tags:
  - 개발
draft: true
---
Giftify에서  “친구의 위시리스트에 펀딩을 거는” 기능을 설계하면서, 자연스럽게 
1. 출발점: Friend = Member–Member N:N 중간 테이블?
처음 다이어그램을 그렸을 때, 백엔드의 


즉, Member와 Member의 N:N 관계를 
> “Friend가 Member와 Member의 N:N 관계를 풀어내는 N:1 매핑 중간 테이블이면 되는 것이죠?”
답은 
이 시점의 이해:


2. 두 번째 의문: requester/receiver라면 인스타처럼 “서로 팔로우” 구조인가?
다이어그램을 보면 
> “requesterId, receiverId로 표현되는 것으로 보아 서로 팔로우를 해야 하는 이중 구조인가요? 인스타 팔로우처럼?”
여기서 정리한 핵심:

인스타/트위터식 모델은 보통 이렇게 생겼습니다.

즉, 이 모델은 인스타식 “서로 팔로우 두 줄”이 아니라,


이 단계에서 정리한 점:


3. 세 번째 질문: 인스타식 팔로우 + 요청/수락 모델로도 친구를 표현할 수 있지 않나?
그러다 다시 이런 생각이 들었습니다.
> “근데 인스타도 팔로우 요청 수락 같은 기능 있잖아요.

> 그거라고 생각하면요? 단순한 두 관계로 친구 관계를 풀어낼 수 있지 않나요?”
여기서 한 번, “인스타식으로 친구를 정의하면 어떤 모습이 되는지”를 상상해봤습니다.
3.1. 인스타식 Follow로 친구 정의하기
예를 들어 다음과 같은 테이블만 있다고 해봅니다.
Follow  
- followerId  
- followeeId  
- status: PENDING / ACCEPTED / REJECTED  


그러면 “친구”를 이렇게 정의할 수 있습니다.

A와 B가 친구다

⇔ 
장점:

DB 테이블 구조는 단순합니다.
모든 관계는 “A가 B를 follow 한다” 하나뿐

‘친구’라는 개념을 별도 테이블로 만들지 않아도 됩니다.


하지만 단점이 동시에 드러났습니다.


이 시점에서 나온 결론:


4. 네 번째 질문: requester / receiver의 비대칭 의미, 괜찮은가?
다음으로 마음에 걸린 포인트는 이거였습니다.
> “그러면 한쪽이 requester고 한쪽은 receiver인 비대칭적인 의미가 담기는데 괜찮은 걸까요?”
여기서 다시 한 번 “현재 관계 vs 과거 기록”을 분리해서 고민했습니다.
4.1. 비대칭은 “생성 시점의 메타 정보”로 보기
Friendship(requesterId, receiverId, status=ACCEPTED)


즉, 도메인에서 “A와 B가 친구인가?”를 판단할 때는

단지 “이 두 사람을 묶는 ACCEPTED 관계가 존재하는지”만 보면 됩니다.
쿼리 관점에서는:


이렇게 
4.2. 이름이 거슬린다면 바꿔볼 수 있는 패턴들
그래도 


즉, 비대칭이 “개념 문제”라기보다는, 
5. 마지막 확인: 친구 끊기(언프렌드) 동작은 어떻게 되나?
마지막으로 확인하고 싶었던 부분은 이것입니다.
> “그러면 이 모델의 경우 누군가 친구 관계를 끊으면 서로 모두 알 수 있겠네요?

> 하지만 Giftify는 친구 관계가 일급 시민이니까 그게 맞는 모델링이고요?”
여기서 결정이 확실해졌습니다.

Friendship은 “두 사람 사이의 단 하나의 관계 객체”입니다.
한쪽이 “친구 끊기”를 하면:
Friendship을 삭제하거나 상태를 TERMINATED/DELETED로 변경
그 순간부터 두 사람 모두 
이 동작은 Giftify의 요구사항과 잘 맞았습니다.

Giftify에서 “친구 여부”는 위시리스트 공개 범위(공개/친구공개/비공개)와

펀딩 가능 여부(“친구의 위시리스트에만 펀딩 허용” 같은 정책)에 직결됩니다.
따라서 “친구인가?”는 서비스 전체에서 매우 중요한 질문이고,

그 답을 책임지는 
반대로, Follow 두 개로 친구를 정의했다면:

A가 B 팔로우를 끊어도, B→A는 그대로일 수 있고,
양방향 Follow 중 무엇이 언제 끊겼는지에 따라

“이걸 친구 해제라고 볼지?”, “한쪽만 더 이상 친구라고 인식하는 상태를 허용할지?” 같은 복잡한 케이스를 모두 다뤄야 합니다.


Giftify처럼 
6. 정리: Giftify에서 선택한 방향
질문과 답변을 쭉 따라간 뒤, Giftify 친구 관계 모델링에 대한 결론은 이렇게 정리할 수 있습니다.


이 과정을 통해, 단순히 “어떤 테이블 구조가 깔끔한가?”를 넘어서,

“우리 도메인에서 진짜로 중요한 1급 개념이 무엇인가?”를 기준으로 모델을 선택하게 되었습니다.

Giftify에서는 그게 바로 





































































